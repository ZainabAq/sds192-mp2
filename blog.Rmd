---
title: "Mini-Project 2"
author: "Jessica Keast, Zainab Rizvi, Rachel LaFlamme"
date: "March 24, 2017"
output: html_document
---


## Loading the data

```{r, include=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r}
library(tidyverse)
library(ggplot2)
```

```{r}
new_house <- house_elections %>%
  select(party, primary_votes, general_votes, state, ge_winner) %>%
  filter(party == "R" | party == "D")
  
filterVotes(field = "primary_votes")
filterVotes(field = "general_votes")

finalData <- new_house %>%
  #filter(primary_votes > 0 & general_votes > 0) %>%
  mutate(diff = general_votes - primary_votes) %>%
  arrange(desc(diff)) %>%
  top_n(100)

filterVotes <- function(field) {
  new_house %>%
    filter(field > 0)
}

ggplot(finalData, aes(x = primary_votes, y = general_votes)) + geom_point(aes(color = party))
```